<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sign In — VibeScript Builder</title>
<meta name="color-scheme" content="dark" />
<style>
  :root { color-scheme: dark; }
  body{
    margin:0;
    background:#0b1020 url('/bg-stars.webp') center/cover no-repeat fixed;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  }
  .wrap{min-height:100dvh;display:grid;place-items:center;padding:16px}
  .card{
    width:min(92vw,480px);
    background:linear-gradient(180deg,rgba(15,23,42,.85),rgba(2,6,23,.9));
    border:1px solid rgba(255,255,255,.08);
    border-radius:22px;
    padding:22px;
    color:#e5e7eb;
    box-shadow:0 10px 50px rgba(0,0,0,.45);
    backdrop-filter:blur(8px);
  }
  .brand{display:flex;gap:12px;align-items:center;margin-bottom:6px}
  .logo{width:32px;height:32px;border-radius:10px;background:#111 url('/logo-128.png') center/cover no-repeat}
  h1{margin:0;font-size:26px;font-weight:900}
  p.muted{margin:6px 0 16px;color:#9ca3af}
  label{display:block;font-size:12px;color:#9ca3af;margin:10px 0 6px}
  input{
    width:100%;border-radius:12px;border:1px solid rgba(255,255,255,.18);
    background:rgba(255,255,255,.06);color:#fff;padding:.7rem .8rem;font-size:.95rem
  }
  input:focus{outline:none;border-color:#22d3ee;box-shadow:0 0 0 3px rgba(34,211,238,.2)}
  .btn{width:100%;border:0;border-radius:16px;padding:.85rem 1rem;font-weight:800;cursor:pointer}
  .btn-primary{background:linear-gradient(90deg,#fb7185,#f59e0b,#22d3ee,#a78bfa);color:#111}
  .muted-sm{color:#9ca3af;font-size:12px;text-align:center}
  .link{color:#e5e7eb;text-decoration:underline;text-underline-offset:3px}
  .banner{display:none;margin:0 0 12px;padding:10px 12px;border-radius:12px;font-size:13px;text-align:center}
  .ok{border:1px solid rgba(34,197,94,.35);background:rgba(34,197,94,.12);color:#d1fae5}
  .bad{border:1px solid rgba(248,113,113,.35);background:rgba(248,113,113,.10);color:#fecaca}
</style>
</head>
<body>
  <main class="wrap">
    <div class="card">
      <div id="banner" class="banner"></div>

      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <h1>VibeScript Builder</h1>
      </div>
      <p class="muted">Sign in with email & password. (Google sign-in is disabled until OAuth is wired.)</p>

      <form id="formSignIn" method="POST" action="/api/signin">
        <label for="email">Email</label>
        <input id="email" name="email" type="email" required autocomplete="email" placeholder="you@example.com" />
        <label for="password">Password</label>
        <input id="password" name="password" type="password" required autocomplete="current-password" placeholder="••••••••" />
        <div style="height:10px"></div>
        <button class="btn btn-primary" type="submit">Sign in</button>
      </form>

      <p class="muted-sm" style="margin-top:14px">New here? <a class="link" href="/signup">Create account</a></p>
      <p class="muted-sm" style="margin-top:14px">By continuing you agree to our <a class="link" href="/terms.html">terms</a> and <a class="link" href="/privacy.html">privacy policy</a>.</p>
    </div>
  </main>

<script>
  // keep email sticky between attempts
  const emailEl = document.getElementById('email');
  const last = sessionStorage.getItem('lastEmail') || '';
  if (last && !emailEl.value) emailEl.value = last;
  document.getElementById('formSignIn').addEventListener('submit', () => {
    sessionStorage.setItem('lastEmail', (emailEl.value||'').trim());
  });

  // show banner if the server redirected with ?msg=...
  const params = new URLSearchParams(location.search);
  const msg = params.get('msg');
  const ok = params.get('ok');
  if (msg) {
    const b = document.getElementById('banner');
    b.textContent = msg;
    b.className = 'banner ' + (ok === '1' ? 'ok' : 'bad');
    b.style.display = 'block';
  }
</script>
</body>
</html>
